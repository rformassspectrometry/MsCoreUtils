<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spectra Distance/Similarity Measurements — distance • MsCoreUtils</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spectra Distance/Similarity Measurements — distance"><meta property="og:description" content="These functions provide different normalized similariy/distance measurements."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsCoreUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MsCoreUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spectra Distance/Similarity Measurements</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/blob/HEAD/R/distance.R" class="external-link"><code>R/distance.R</code></a></small>
    <div class="hidden name"><code>distance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions provide different normalized similariy/distance measurements.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ndotproduct</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">0L</span>, n <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">dotproduct</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">0L</span>, n <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">neuclidean</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">0L</span>, n <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">navdist</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">0L</span>, n <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">nspectraangle</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">0L</span>, n <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code>matrix</code>, two-columns e.g. m/z, intensity</p></dd>
<dt>y</dt>
<dd><p><code>matrix</code>, two-columns e.g. m/z, intensity</p></dd>
<dt>m</dt>
<dd><p><code>numeric</code>, weighting for the first column of <code>x</code> and <code>y</code> (e.g.
"mz"), default: <code>0</code> means don't weight by the first column. For more details
see the <code>ndotproduct</code> details section.</p></dd>
<dt>n</dt>
<dd><p><code>numeric</code>, weighting for the second column of <code>x</code> and <code>y</code> (e.g.
"intensity"), default: <code>0.5</code> means effectly using <code>sqrt(x[,2])</code> and
<code>sqrt(y[,2])</code>. For more details see the <code>ndotproduct</code> details section.</p></dd>
<dt>na.rm</dt>
<dd><p><code>logical(1)</code>, should <code>NA</code> be removed prior to calculation
(default <code>TRUE</code>).</p></dd>
<dt>...</dt>
<dd><p>ignored.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>double(1)</code> value between <code>0:1</code>, where <code>0</code> is completely different
and <code>1</code> identically.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>All functions that calculate normalized similarity/distance measurements are
prefixed with a <em>n</em>.</p>
<p><code>ndotproduct</code>: the normalized dot product is described in Stein and Scott
1994 as: \(NDP = \frac{\sum(W_1 W_2)^2}{\sum(W_1)^2 \sum(W_2)^2}\); where
\(W_i = x^m * y^n\), where \(x\) and \(y\) are the m/z and intensity
values, respectively. Please note also that \(NDP = NCos^2\); where NCos
is the cosine value (i.e. the orthodox normalized dot product) of the
intensity vectors as described in Yilmaz et al. 2017. Stein and Scott 1994
empirically determined the optimal exponents as <code>m = 3</code> and <code>n = 0.6</code> by
analyzing ca. 12000 EI-MS data of 8000 organic compounds in the NIST Mass
Spectral Library.
MassBank (Horai et al. 2010) uses <code>m = 2</code> and <code>n = 0.5</code>
for small compounds. In general with increasing values for <code>m</code>,
high m/z values will be taken more into account for similarity calculation.
Especially when working with small molecules, a value <code>n &gt; 0</code> can be set
to give a weight on the m/z values to accommodate that shared fragments
with higher m/z are less likely and will mean that molecules might be more
similar. Increasing <code>n</code> will result in a higher importance of the intensity
values. Most commonly <code>m = 0</code> and <code>n = 0.5</code> are used.</p>
<p><code>neuclidean</code>: the normalized euclidean distance is described in Stein and
Scott 1994 as:
\(NED = (1 + \frac{\sum((W_1 - W_2)^2)}{sum((W_2)^2)})^{-1}\); where
\(W_i = x^m * y^n\), where \(x\) and \(y\) are the m/z and intensity
values, respectively. See the details section about <code>ndotproduct</code> for an
explanation how to set <code>m</code> and <code>n</code>.</p>
<p><code>navdist</code>: the normalized absolute values distance is described in Stein and
Scott 1994 as:
\(NED = (1 + \frac{\sum(|W_1 - W_2|)}{sum((W_2))})^{-1}\); where
\(W_i = x^m * y^n\), where \(x\) and \(y\) are the m/z and intensity
values, respectively. See the details section about <code>ndotproduct</code> for an
explanation how to set <code>m</code> and <code>n</code>.</p>
<p><code>nspectraangle</code>: the normalized spectra angle is described in Toprak et al
2014 as:
\(NSA = 1 - \frac{2*\cos^{-1}(W_1 \cdot W_2)}{\pi}\); where
\(W_i = x^m * y^n\), where \(x\) and \(y\) are the m/z and intensity
values, respectively. The weighting was not originally proposed by Toprak et
al. 2014. See the details section about <code>ndotproduct</code> for an explanation how
to set <code>m</code> and <code>n</code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>These methods are implemented as described in Stein and Scott 1994
(<code>navdist</code>, <code>ndotproduct</code>, <code>neuclidean</code>) and Toprak et al. 2014
(<code>nspectraangle</code>) but because there is no reference implementation available
we are unable to guarantee that the results are identical.
Note that the Stein and Scott 1994 normalized dot product method (and by
extension <code>ndotproduct</code>) corresponds to the square of the orthodox
normalized dot product (or cosine distance) used also commonly as spectrum
similarity measure (Yilmaz et al. 2017).
Please see also the corresponding discussion at the github pull request
linked below. If you find any problems or reference implementation please
open an issue at
<a href="https://github.com/rformassspectrometry/MsCoreUtils/issues" class="external-link">https://github.com/rformassspectrometry/MsCoreUtils/issues</a>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Stein, S. E., and Scott, D. R. (1994).
Optimization and testing of mass spectral library search algorithms for
compound identification.
Journal of the American Society for Mass Spectrometry, 5(9), 859--866.
doi: <a href="https://doi.org/10.1016/1044-0305(94)87009-8" class="external-link">10.1016/1044-0305(94)87009-8</a>
.</p>
<p>Yilmaz, S., Vandermarliere, E.,  and Lennart Martens (2017).
Methods to Calculate Spectrum Similarity.
In S. Keerthikumar and S. Mathivanan (eds.), Proteome
Bioinformatics: Methods in Molecular Biology, vol. 1549 (pp. 81).
doi: <a href="https://doi.org/10.1007/978-1-4939-6740-7_7" class="external-link">10.1007/978-1-4939-6740-7_7</a>
.</p>
<p>Horai et al. (2010).
MassBank: a public repository for sharing mass spectral data for life
sciences. Journal of mass spectrometry, 45(7), 703--714.
doi: <a href="https://doi.org/10.1002/jms.1777" class="external-link">10.1002/jms.1777</a>
.</p>
<p>Toprak et al. (2014).
Conserved peptide fragmentation as a benchmarking tool for mass spectrometers
and a discriminating feature for targeted proteomics.
Molecular &amp; Cellular Proteomics : MCP, 13(8), 2056--2071.
doi: <a href="https://doi.org/10.1074/mcp.O113.036475" class="external-link">10.1074/mcp.O113.036475</a>
.</p>
<p>Pull Request for these distance/similarity measurements:
<a href="https://github.com/rformassspectrometry/MsCoreUtils/pull/33" class="external-link">https://github.com/rformassspectrometry/MsCoreUtils/pull/33</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other distance/similarity functions: 
<code><a href="gnps.html">gnps</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><code>navdist</code>, <code>neuclidean</code>, <code>nspectraangle</code>: Sebastian Gibb</p>
<p><code>ndotproduct</code>: Sebastian Gibb and
Thomas Naake, <a href="mailto:thomasnaake@googlemail.com">thomasnaake@googlemail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ndotproduct</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7660906</span>
<span class="r-in"><span class="fu">ndotproduct</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9074293</span>
<span class="r-in"><span class="fu">ndotproduct</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, m <span class="op">=</span> <span class="fl">3</span>, n <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9127553</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">neuclidean</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8003406</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">navdist</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6970151</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">nspectraangle</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5556013</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

