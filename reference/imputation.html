<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The impute_matrix function performs data imputation on matrix
objects instance using a variety of methods (see below).
Users should proceed with care when imputing data and take
precautions to assure that the imputation produces valid results,
in particular with naive imputations such as replacing missing
values with 0."><title>Quantitative mass spectrometry data imputation — impute_matrix • MsCoreUtils</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative mass spectrometry data imputation — impute_matrix"><meta property="og:description" content="The impute_matrix function performs data imputation on matrix
objects instance using a variety of methods (see below).
Users should proceed with care when imputing data and take
precautions to assure that the imputation produces valid results,
in particular with naive imputations such as replacing missing
values with 0."><meta property="og:image" content="https://rformassspectrometry.github.io/MsCoreUtils/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MsCoreUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.15.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MsCoreUtils.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MsCoreUtils/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quantitative mass spectrometry data imputation</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/blob/HEAD/R/imputation.R" class="external-link"><code>R/imputation.R</code></a></small>
      <div class="d-none name"><code>imputation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>impute_matrix</code> function performs data imputation on <code>matrix</code>
objects instance using a variety of methods (see below).</p>
<p>Users should proceed with care when imputing data and take
precautions to assure that the imputation produces valid results,
in particular with naive imputations such as replacing missing
values with 0.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">method</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">imputeMethods</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_neighbour_average</span><span class="op">(</span><span class="va">x</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, MARGIN <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_knn</span><span class="op">(</span><span class="va">x</span>, MARGIN <span class="op">=</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_mle</span><span class="op">(</span><span class="va">x</span>, MARGIN <span class="op">=</span> <span class="fl">2L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_bpca</span><span class="op">(</span><span class="va">x</span>, MARGIN <span class="op">=</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_RF</span><span class="op">(</span><span class="va">x</span>, MARGIN <span class="op">=</span> <span class="fl">2L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_mixed</span><span class="op">(</span><span class="va">x</span>, <span class="va">randna</span>, <span class="va">mar</span>, <span class="va">mnar</span>, MARGIN <span class="op">=</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_min</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_MinDet</span><span class="op">(</span><span class="va">x</span>, q <span class="op">=</span> <span class="fl">0.01</span>, MARGIN <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_MinProb</span><span class="op">(</span><span class="va">x</span>, q <span class="op">=</span> <span class="fl">0.01</span>, sigma <span class="op">=</span> <span class="fl">1</span>, MARGIN <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_QRILC</span><span class="op">(</span><span class="va">x</span>, sigma <span class="op">=</span> <span class="fl">1</span>, MARGIN <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_zero</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_with</span><span class="op">(</span><span class="va">x</span>, <span class="va">val</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">impute_fun</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, MARGIN <span class="op">=</span> <span class="fl">1L</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getImputeMargin</span><span class="op">(</span><span class="va">fun</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A matrix or an <code>HDF5Matrix</code> object to be imputed.</p></dd>


<dt>method</dt>
<dd><p><code>character(1)</code> defining the imputation method. See
<code>imputeMethods()</code> for available ones.</p></dd>


<dt>FUN</dt>
<dd><p>A user-provided function that takes a <code>matrix</code> as input and
returns an imputed <code>matrix</code> of identical dimensions.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters passed to the inner imputation
function.</p></dd>


<dt>k</dt>
<dd><p><code>numeric(1)</code> providing the imputation value used for the
first and last samples if they contain an <code>NA</code>. The default is
to use the smallest value in the data.</p></dd>


<dt>MARGIN</dt>
<dd><p><code>integer(1)</code> defining the margin along which to
apply imputation, with <code>1L</code> for rows and <code>2L</code> for columns. The
default value will depend on the imputation method. Use
<code>getImputeMargin(fun)</code> to get the default margin of imputation
function <code>fun</code>. If the function doesn't take a margin
argument, <code>NA</code> is returned.</p></dd>


<dt>randna</dt>
<dd><p><code>logical</code> of length equal to <code>nrow(object)</code> defining
which rows are missing at random. The other ones are
considered missing not at random. Only relevant when <code>methods</code>
is <code>mixed</code>.</p></dd>


<dt>mar</dt>
<dd><p>Imputation method for values missing at random. See
<code>method</code> above.</p></dd>


<dt>mnar</dt>
<dd><p>Imputation method for values missing not at
random. See <code>method</code> above.</p></dd>


<dt>q</dt>
<dd><p><code>numeric(1)</code> indicating the quantile to be used to
estimate the minimum in <code>MinDet</code> and <code>MinProb</code>. Default is
0.01.</p></dd>


<dt>sigma</dt>
<dd><p><code>numeric(1)</code> controling the standard deviation of the
MNAR distribution in <code>MinProb</code> and <code>QRILC</code>. Default is 1.</p></dd>


<dt>val</dt>
<dd><p><code>numeric(1)</code> used to replace all missing values.</p></dd>


<dt>fun</dt>
<dd><p>The imputation function to get the default margin from.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix of same class as <code>x</code> with dimensions <code>dim(x)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="types-of-missing-values">Types of missing values<a class="anchor" aria-label="anchor" href="#types-of-missing-values"></a></h2>
    


<p>There are two types of mechanisms resulting in missing values in
LC/MSMS experiments.</p><ul><li><p>Missing values resulting from absence of detection of a feature,
despite ions being present at detectable concentrations. For
example in the case of ion suppression or as a result from the
stochastic, data-dependent nature of the DDA MS acquisition
method. These missing value are expected to be randomly
distributed in the data and are defined, in statistical terms,
as missing at random (MAR) or missing completely at random (MCAR).</p></li>
<li><p>Biologically relevant missing values resulting from the absence
or the low abundance of ions (i.e. below the limit of detection of
the instrument). These missing values are not expected to be
randomly distributed in the data and are defined as missing not
at random (MNAR).</p></li>
</ul><p>MNAR features should ideally be imputed with a left-censor method,
such as <code>QRILC</code> below. Conversely, it is recommended to use hot
deck methods such nearest neighbours, Bayesian missing value
imputation or maximum likelihood methods when values are missing
at random.</p>
    </div>
    <div class="section level2">
    <h2 id="imputing-by-rows-or-columns">Imputing by rows or columns<a class="anchor" aria-label="anchor" href="#imputing-by-rows-or-columns"></a></h2>
    


<p>We assume that the input matrix <code>x</code> contains features along the
rows and samples along the columns, as is generally the case in
omics data analysis. When performing imputation, the missing
values are taken as a feature-specific property: feature <em>x</em> is
missing because it is absent (in a sample or group), or because it
was missed during acquisition (not selected during data dependent
acquisition) or data processing (not identified or with an
identification score below a chosen false discovery threshold). As
such, imputation is by default performed at the <em>feature
level</em>. In some cases, such as imputation by zero or a global
minimum value, it doesn't matter. In other cases, it does matter
very much, such as for example when using the minimum value
computed for each margin (i.e. row or column) as in the <em>MinDet</em>
method (see below) - do we want to use the minimum of the sample
or of that feature? KNN is another such example: do we consider
the most similar features to impute a feature with missing values,
or the most similar samples to impute all missing in a sample.</p>
<p>The <code>MARGIN</code> argument can be used to change the imputation margin
from features/rows (<code>MARGIN = 1</code>) to samples/columns (<code>MARGIN = 2</code>).
Different imputations will have different default values, and
changing this parameter can have a major impact on imputation results
and downstream results.</p>
    </div>
    <div class="section level2">
    <h2 id="imputation-methods">Imputation methods<a class="anchor" aria-label="anchor" href="#imputation-methods"></a></h2>
    


<p>Currently, the following imputation methods are available.</p><ul><li><p><em>MLE</em>: Maximum likelihood-based imputation method using the EM
algorithm. The <code>impute_mle()</code> function relies on
<code><a href="https://rdrr.io/pkg/norm/man/imp.norm.html" class="external-link">norm::imp.norm()</a></code>. function. See <code><a href="https://rdrr.io/pkg/norm/man/imp.norm.html" class="external-link">norm::imp.norm()</a></code> for details
and additional parameters. Note that here, <code>...</code> are passed to
the <code><a href="https://rdrr.io/pkg/norm/man/em.norm.html" class="external-link">norm::em.norm()</a></code> function, rather to the actual imputation
function <code>imp.norm</code>.</p></li>
<li><p><em>bpca</em>: Bayesian missing value imputation are available, as
implemented in the <code><a href="https://rdrr.io/pkg/pcaMethods/man/pca.html" class="external-link">pcaMethods::pca()</a></code> function. See
<code><a href="https://rdrr.io/pkg/pcaMethods/man/pca.html" class="external-link">pcaMethods::pca()</a></code> for details and additional parameters.</p></li>
<li><p><em>RF</em>: Random Forest imputation, as implemented in the
<code><a href="https://rdrr.io/pkg/missForest/man/missForest.html" class="external-link">missForest::missForest</a></code> function. See <code><a href="https://rdrr.io/pkg/missForest/man/missForest.html" class="external-link">missForest::missForest()</a></code>] for
details and additional parameters.</p></li>
<li><p><em>knn</em>: Nearest neighbour averaging, as implemented in the
<code><a href="https://rdrr.io/pkg/impute/man/impute.knn.html" class="external-link">impute::impute.knn</a></code> function. See <code><a href="https://rdrr.io/pkg/impute/man/impute.knn.html" class="external-link">impute::impute.knn()</a></code>] for
details and additional parameters.</p></li>
<li><p><em>QRILC</em>: A missing data imputation method that performs the
imputation of left-censored missing data using random draws from
a truncated distribution with parameters estimated using
quantile regression. The <code>impute_QRILC()</code> function calls
<code><a href="https://rdrr.io/pkg/imputeLCMD/man/impute.QRILC.html" class="external-link">imputeLCMD::impute.QRILC()</a></code> from the <code>imputeLCMD</code> package.</p></li>
<li><p><em>MinDet</em>: Performs the imputation of left-censored missing data
using a deterministic minimal value approach. Considering a
expression data with <em>n</em> samples and <em>p</em> features, for each
sample, the missing entries are replaced with a minimal value
observed in that sample. The minimal value observed is estimated
as being the q-th quantile (default <code>q = 0.01</code>) of the observed
values in that sample. The implementation in based on the
<code><a href="https://rdrr.io/pkg/imputeLCMD/man/impute.MinDet.html" class="external-link">imputeLCMD::impute.MinDet()</a></code> function.</p></li>
<li><p><em>MinProb</em>: Performs the imputation of left-censored missing data
by random draws from a Gaussian distribution centred to a
minimal value. Considering an expression data matrix with <em>n</em>
samples and <em>p</em> features, for each sample, the mean value of the
Gaussian distribution is set to a minimal observed value in that
sample. The minimal value observed is estimated as being the
q-th quantile (default <code>q = 0.01</code>) of the observed values in
that sample. The standard deviation is estimated as the median
of the feature (or sample) standard deviations. Note that when
estimating the standard deviation of the Gaussian distribution,
only the peptides/proteins which present more than 50\<!-- % recorded -->
values are considered. The <code>impute_MinProb()</code> function calls
<code><a href="https://rdrr.io/pkg/imputeLCMD/man/impute.MinProb.html" class="external-link">imputeLCMD::impute.MinProb()</a></code> from the <code>imputeLCMD</code> package.</p></li>
<li><p><em>min</em>: Replaces the missing values with the smallest non-missing
value in the data.</p></li>
<li><p><em>zero</em>: Replaces the missing values with 0.</p></li>
<li><p><em>mixed</em>: A mixed imputation applying two methods (to be defined
by the user as <code>mar</code> for values missing at random and <code>mnar</code> for
values missing not at random, see example) on two M<a href="https://rdrr.io/r/stats/zC.html" class="external-link">C</a>AR/MNAR
subsets of the data (as defined by the user by a <code>randna</code>
logical, of length equal to nrow(object)).</p></li>
<li><p><em>nbavg</em>: Average neighbour imputation for fractions collected
along a fractionation/separation gradient, such as sub-cellular
fractions. The method assumes that the fraction are ordered
along the gradient and is invalid otherwise.</p>
<p>Continuous sets <code>NA</code> value at the beginning and the end of the
quantitation vectors are set to the lowest observed value in the
data or to a user defined value passed as argument <code>k</code>. Then,
when a missing value is flanked by two non-missing neighbouring
values, it is imputed by the mean of its direct neighbours.</p></li>
<li><p><em>with</em>: Replaces all missing values with a user-provided value.</p></li>
<li><p><em>none</em>: No imputation is performed and the missing values are
left untouched. Implemented in case one wants to only impute
value missing at random or not at random with the <em>mixed</em>
method.</p></li>
</ul><p>The <code>imputeMethods()</code> function returns a vector with valid
imputation method names. Use <code>getImputeMargin()</code> to get the
default margin for each imputation function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olga Troyanskaya, Michael Cantor, Gavin Sherlock, Pat Brown,
Trevor Hastie, Robert Tibshirani, David Botstein and Russ B.
Altman, Missing value estimation methods for DNA microarrays
Bioinformatics (2001) 17 (6): 520-525.</p>
<p>Oba et al., A Bayesian missing value estimation method for gene
expression profile data, Bioinformatics (2003) 19 (16): 2088-2096.</p>
<p>Cosmin Lazar (2015). imputeLCMD: A collection of methods for
left-censored missing data imputation. R package version
2.0. <a href="http://CRAN.R-project.org/package=imputeLCMD" class="external-link">http://CRAN.R-project.org/package=imputeLCMD</a>.</p>
<p>Lazar C, Gatto L, Ferro M, Bruley C, Burger T. Accounting for the
Multiple Natures of Missing Values in Label-Free Quantitative
Proteomics Data Sets to Compare Imputation Strategies. J Proteome
Res. 2016 Apr 1;15(4):1116-25. doi:
10.1021/acs.jproteome.5b00981. PubMed PMID:26906401.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## test data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## available methods</span></span></span>
<span class="r-in"><span><span class="fu">imputeMethods</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "bpca"    "knn"     "QRILC"   "MLE"     "MLE2"    "MinDet"  "MinProb"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "min"     "zero"    "mixed"   "nbavg"   "with"    "RF"      "none"   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"zero"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A         B         C          D         E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.9391243 3.6872085 0.0000000 1.57688302 1.2287515 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.5685317 9.8418666 0.1684176 0.00000000 0.6969391 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.4378205 0.2493592 0.8420488 2.81539768 0.0000000 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.8829931 0.7566997 3.3691979 0.54393454 0.0000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.4982059 0.8751838 6.6538355 1.65691116 0.2545441 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.8993127 0.0000000 0.6502040 0.17960259 1.5415957 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.5336257 0.0000000 0.7731599 0.45636653 0.4442387 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.9096830 0.0701966 0.1715015 0.42702719 4.2380415 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.0000000 0.0000000 0.0000000 0.08943818 0.6495690 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.9392120 3.7438457 0.5272951 1.03678296 1.9263902 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            A          B          C          D          E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.93912433 3.68720845 0.05013228 1.57688302 1.22875148 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.56853172 9.84186664 0.16841764 0.05013228 0.69693906 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.43782048 0.24935924 0.84204876 2.81539768 0.05013228 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.88299314 0.75669973 3.36919788 0.54393454 0.05013228 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.49820590 0.87518382 6.65383554 1.65691116 0.25454413 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.89931266 0.05013228 0.65020399 0.17960259 1.54159566 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.53362571 0.05013228 0.77315991 0.45636653 0.44423873 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.90968305 0.07019660 0.17150153 0.42702719 4.23804154 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.05013228 0.05013228 0.05013228 0.08943818 0.64956901 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.93921196 3.74384570 0.52729513 1.03678296 1.92639019 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"knn"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: impute</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing along margin 1 (features/rows).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A         B         C          D         E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.9391243 3.6872085 1.8777229 1.57688302 1.2287515 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.5685317 9.8418666 0.1684176 0.93096390 0.6969391 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.4378205 0.2493592 0.8420488 2.81539768 1.3352059 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.8829931 0.7566997 3.3691979 0.54393454 1.3352059 1.54557696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.4982059 0.8751838 6.6538355 1.65691116 0.2545441 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.8993127 2.5204465 0.6502040 0.17960259 1.5415957 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.5336257 2.5204465 0.7731599 0.45636653 0.4442387 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.9096830 0.0701966 0.1715015 0.42702719 4.2380415 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 1.6608509 2.5204465 1.8777229 0.08943818 0.6495690 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.9392120 3.7438457 0.5272951 1.03678296 1.9263902 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## same as impute_zero</span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"with"</span>, val <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A         B         C          D         E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.9391243 3.6872085 0.0000000 1.57688302 1.2287515 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.5685317 9.8418666 0.1684176 0.00000000 0.6969391 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.4378205 0.2493592 0.8420488 2.81539768 0.0000000 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.8829931 0.7566997 3.3691979 0.54393454 0.0000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.4982059 0.8751838 6.6538355 1.65691116 0.2545441 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.8993127 0.0000000 0.6502040 0.17960259 1.5415957 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.5336257 0.0000000 0.7731599 0.45636653 0.4442387 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.9096830 0.0701966 0.1715015 0.42702719 4.2380415 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.0000000 0.0000000 0.0000000 0.08943818 0.6495690 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.9392120 3.7438457 0.5272951 1.03678296 1.9263902 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## impute with half of the smalles value</span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"with"</span>,</span></span>
<span class="r-in"><span>              val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">m</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            A          B          C          D          E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.93912433 3.68720845 0.02506614 1.57688302 1.22875148 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.56853172 9.84186664 0.16841764 0.02506614 0.69693906 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.43782048 0.24935924 0.84204876 2.81539768 0.02506614 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.88299314 0.75669973 3.36919788 0.54393454 0.02506614 0.02506614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.49820590 0.87518382 6.65383554 1.65691116 0.25454413 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.89931266 0.02506614 0.65020399 0.17960259 1.54159566 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.53362571 0.02506614 0.77315991 0.45636653 0.44423873 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.90968305 0.07019660 0.17150153 0.42702719 4.23804154 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.02506614 0.02506614 0.02506614 0.08943818 0.64956901 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.93921196 3.74384570 0.52729513 1.03678296 1.92639019 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## all but third and fourth features' missing values</span></span></span>
<span class="r-in"><span><span class="co">## are the result of random missing values</span></span></span>
<span class="r-in"><span><span class="va">randna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">randna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, method <span class="op">=</span> <span class="st">"mixed"</span>,</span></span>
<span class="r-in"><span>              randna <span class="op">=</span> <span class="va">randna</span>,</span></span>
<span class="r-in"><span>              mar <span class="op">=</span> <span class="st">"knn"</span>,</span></span>
<span class="r-in"><span>              mnar <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing along margin 1 (features/rows).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            A          B          C          D          E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.93912433 3.68720845 2.35451487 1.57688302 1.22875148 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.56853172 9.84186664 0.16841764 0.74593934 0.69693906 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.43782048 0.24935924 0.84204876 2.81539768 0.05013228 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.88299314 0.75669973 3.36919788 0.54393454 1.34408497 1.44241604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.49820590 0.87518382 6.65383554 1.65691116 0.25454413 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.89931266 2.42140409 0.65020399 0.17960259 1.54159566 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.53362571 2.42140409 0.77315991 0.45636653 0.44423873 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.90968305 0.07019660 0.17150153 0.42702719 4.23804154 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.05013228 0.05013228 0.05013228 0.08943818 0.64956901 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.93921196 3.74384570 0.52729513 1.03678296 1.92639019 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## user provided (random) imputation function</span></span></span>
<span class="r-in"><span><span class="va">random_imp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">sdev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">m</span>, sd <span class="op">=</span> <span class="va">sdev</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">x</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impute_matrix</span><span class="op">(</span><span class="va">m</span>, FUN <span class="op">=</span> <span class="va">random_imp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing along margin 1 (features/rows).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A          B          C          D          E          F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 3.9391243  3.6872085 -0.9827978 1.57688302  1.2287515 1.37978165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.5685317  9.8418666  0.1684176 3.34043209  0.6969391 0.45664959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.4378205  0.2493592  0.8420488 2.81539768  4.6343602 4.83425736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.8829931  0.7566997  3.3691979 0.54393454 -0.3031275 0.79093969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.4982059  0.8751838  6.6538355 1.65691116  0.2545441 1.09391242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.8993127  2.0228995  0.6502040 0.17960259  1.5415957 1.31857387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 4.5336257 -0.6151082  0.7731599 0.45636653  0.4442387 1.97247444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.9096830  0.0701966  0.1715015 0.42702719  4.2380415 1.09399145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 4.5173132  2.2355807  3.0879489 0.08943818  0.6495690 0.05013228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.9392120  3.7438457  0.5272951 1.03678296  1.9263902 1.32960639</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## get the default margin</span></span></span>
<span class="r-in"><span><span class="fu">getImputeMargin</span><span class="op">(</span><span class="va">impute_knn</span><span class="op">)</span> <span class="co">## default imputes along features</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">getImputeMargin</span><span class="op">(</span><span class="va">impute_mle</span><span class="op">)</span> <span class="co">## default imputes along samples</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">getImputeMargin</span><span class="op">(</span><span class="va">impute_zero</span><span class="op">)</span> <span class="co">## NA: no margin here</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## default margin for all MsCoreUtils::impute_* functions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="st">"package:MsCoreUtils"</span>, pattern <span class="op">=</span> <span class="st">"impute_"</span><span class="op">)</span>, <span class="va">getImputeMargin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            impute_MinDet           impute_MinProb             impute_QRILC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        2                        2                        2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                impute_RF              impute_bpca               impute_fun </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        2                        1                        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               impute_knn            impute_matrix               impute_min </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        1                       NA                       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             impute_mixed               impute_mle impute_neighbour_average </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        1                        2                        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              impute_with              impute_zero </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       NA                       NA </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

