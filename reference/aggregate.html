<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions take a matrix of quantitative features x and
aggregate the features (rows) according to either a vector (or
factor) INDEX or an adjacency matrix MAT. The aggregation
method is defined by function FUN.
Adjacency matrices are an elegant way to explicitly encode for
shared peptides (see example below) during aggregation."><title>Aggreagate quantitative features — aggregate • MsCoreUtils</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggreagate quantitative features — aggregate"><meta property="og:description" content="These functions take a matrix of quantitative features x and
aggregate the features (rows) according to either a vector (or
factor) INDEX or an adjacency matrix MAT. The aggregation
method is defined by function FUN.
Adjacency matrices are an elegant way to explicitly encode for
shared peptides (see example below) during aggregation."><meta property="og:image" content="https://rformassspectrometry.github.io/MsCoreUtils/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MsCoreUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.15.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MsCoreUtils.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MsCoreUtils/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Aggreagate quantitative features</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/blob/HEAD/R/aggregate.R" class="external-link"><code>R/aggregate.R</code></a>, <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/blob/HEAD/R/aggregate_by_matrix.R" class="external-link"><code>R/aggregate_by_matrix.R</code></a>, <a href="https://github.com/RforMassSpectrometry/MsCoreUtils/blob/HEAD/R/aggregate_by_vector.R" class="external-link"><code>R/aggregate_by_vector.R</code></a></small>
      <div class="d-none name"><code>aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions take a matrix of quantitative features <code>x</code> and
aggregate the features (rows) according to either a vector (or
factor) <code>INDEX</code> or an adjacency matrix <code>MAT</code>. The aggregation
method is defined by function <code>FUN</code>.</p>
<p>Adjacency matrices are an elegant way to explicitly encode for
shared peptides (see example below) during aggregation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">colMeansMat</span><span class="op">(</span><span class="va">x</span>, <span class="va">MAT</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">colSumsMat</span><span class="op">(</span><span class="va">x</span>, <span class="va">MAT</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">aggregate_by_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">MAT</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">INDEX</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A <code>matrix</code> of mode <code>numeric</code> or an <code>HDF5Matrix</code> object of
type <code>numeric</code>.</p></dd>


<dt>MAT</dt>
<dd><p>An adjacency matrix that defines peptide-protein
relations with <code>nrow(MAT) == nrow(x)</code>: a non-missing/non-null
value at position (i,j) indicates that peptide i belong to
protein j. This matrix is tyically binary but can also contain
weighted relations.</p></dd>


<dt>na.rm</dt>
<dd><p>A <code>logical(1)</code> indicating whether the missing values
(including NaN) should be omitted from the calculations or not.
Defaults to <code>FALSE</code>.</p></dd>


<dt>FUN</dt>
<dd><p>A <code>function</code> to be applied to the subsets of <code>x</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code>FUN</code>.</p></dd>


<dt>INDEX</dt>
<dd><p>A <code>vector</code> or <code>factor</code> of length <code>nrow(x)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>aggregate_by_matrix()</code> returns a <code>matrix</code> (or <code>Matrix</code>)
of dimensions <code>ncol(MAT)</code> and <code>ncol(x), with </code>dimnames<code>equal to</code>colnames(x)<code>and</code>rownames(MAT)`.</p>


<p><code>aggregate_by_vector()</code> returns a new <code>matrix</code> (if <code>x</code> is
a <code>matrix</code>) or <code>HDF5Matrix</code> (if <code>x</code> is an <code>HDF5Matrix</code>)
of dimensions <code>length(INDEX)</code> and <code>ncol(x), with </code>dimnames<code> equal to</code>colnames(x)<code>and</code>INDEX`.</p>
    </div>
    <div class="section level2">
    <h2 id="vector-based-aggregation-functions">Vector-based aggregation functions<a class="anchor" aria-label="anchor" href="#vector-based-aggregation-functions"></a></h2>
    


<p>When aggregating with a vector/factor, user-defined functions
must return a vector of length equal to <code>ncol(x)</code> for each level
in <code>INDEX</code>. Examples thereof are:</p><ul><li><p><code><a href="medianPolish.html">medianPolish()</a></code> to fits an additive model (two way
decomposition) using Tukey's median polish procedure using
<code><a href="https://rdrr.io/r/stats/medpolish.html" class="external-link">stats::medpolish()</a></code>;</p></li>
<li><p><code><a href="robustSummary.html">robustSummary()</a></code> to calculate a robust aggregation using
<code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::rlm()</a></code>;</p></li>
<li><p><code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colMeans()</a></code> to use the mean of each column;</p></li>
<li><p><code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colSums()</a></code> to use the sum of each column;</p></li>
<li><p><code><a href="https://rdrr.io/pkg/matrixStats/man/rowMedians.html" class="external-link">matrixStats::colMedians()</a></code> to use the median of each column.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="matrix-based-aggregation-functions">Matrix-based aggregation functions<a class="anchor" aria-label="anchor" href="#matrix-based-aggregation-functions"></a></h2>
    


<p>When aggregating with an adjacency matrix, user-defined
functions must return a new matrix. Examples thereof are:</p><ul><li><p><code>colSumsMat(x, MAT)</code> aggregates by the summing the peptide intensities
for each protein. Shared peptides are re-used multiple times.</p></li>
<li><p><code>colMeansMat(x, MAT)</code> aggregation by the calculating the mean of
peptide intensities. Shared peptides are re-used multiple
times.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="handling-missing-values">Handling missing values<a class="anchor" aria-label="anchor" href="#handling-missing-values"></a></h2>
    


<p>By default, missing values in the quantitative data will propagate
to the aggregated data. You can provide <code>na.rm = TRUE</code> to most
functions listed above to ignore missing values, except for
<code><a href="robustSummary.html">robustSummary()</a></code> where you should supply <code>na.action = na.omit</code>
(see <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">?MASS::rlm</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Quantitative feature aggregation: 
<code><a href="colCounts.html">colCounts</a>()</code>,
<code><a href="medianPolish.html">medianPolish</a>()</code>,
<code><a href="robustSummary.html">robustSummary</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto and Samuel Wieczorek (aggregation from an
adjacency matrix).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.39</span>, <span class="fl">17.16</span>, <span class="fl">14.10</span>, <span class="fl">12.85</span>, <span class="fl">10.63</span>, <span class="fl">7.52</span>, <span class="fl">3.91</span>,</span></span>
<span class="r-in"><span>              <span class="fl">11.13</span>, <span class="fl">16.53</span>, <span class="fl">14.17</span>, <span class="fl">11.94</span>, <span class="fl">11.51</span>, <span class="fl">7.69</span>, <span class="fl">3.97</span>,</span></span>
<span class="r-in"><span>              <span class="fl">11.93</span>, <span class="fl">15.37</span>, <span class="fl">14.24</span>, <span class="fl">11.21</span>, <span class="fl">12.29</span>, <span class="fl">9.00</span>, <span class="fl">3.83</span>,</span></span>
<span class="r-in"><span>              <span class="fl">12.90</span>, <span class="fl">14.37</span>, <span class="fl">14.16</span>, <span class="fl">10.12</span>, <span class="fl">13.33</span>, <span class="fl">9.75</span>, <span class="fl">3.81</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            nrow <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Sample1 Sample2 Sample3 Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1   10.39   11.13   11.93   12.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2   17.16   16.53   15.37   14.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3   14.10   14.17   14.24   14.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep4   12.85   11.94   11.21   10.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep5   10.63   11.51   12.29   13.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep6    7.52    7.69    9.00    9.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep7    3.91    3.97    3.83    3.81</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Aggregation by vector</span></span></span>
<span class="r-in"><span><span class="co">## -------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prot"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"E"</span>, <span class="st">"X"</span>, <span class="st">"E"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ProtB" "ProtE" "ProtX" "ProtE" "ProtB" "ProtB" "ProtE"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, <span class="va">colMeans</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Sample1  Sample2  Sample3   Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB  9.513333 10.11000 11.07333 11.993333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtE 11.306667 10.81333 10.13667  9.433333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtX 14.100000 14.17000 14.24000 14.160000</span>
<span class="r-in"><span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, <span class="va">robustSummary</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Sample1  Sample2  Sample3  Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB  9.513333 10.15800 11.07333 11.99333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtE 11.451493 10.81333 10.13667  9.22360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtX 14.100000 14.17000 14.24000 14.16000</span>
<span class="r-in"><span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, <span class="va">medianPolish</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Sample1 Sample2 Sample3 Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB   10.39   11.13   11.93   12.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtE   12.85   11.94   11.21   10.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtX   14.10   14.17   14.24   14.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Aggregation by matrix</span></span></span>
<span class="r-in"><span><span class="co">## -------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              nrow <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prot"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"E"</span>, <span class="st">"X"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adj</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ProtB ProtE ProtX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep4     1     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep5     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep6     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep7     0     1     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Peptide 4 is shared by 2 proteins (has a rowSums of 2),</span></span></span>
<span class="r-in"><span><span class="co">## namely proteins B and E</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1 Pep2 Pep3 Pep4 Pep5 Pep6 Pep7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1    2    1    1    2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">aggregate_by_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">adj</span>, <span class="va">colSumsMat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Sample1 Sample2 Sample3 Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB   41.39   42.27   44.43   46.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtE   33.92   32.44   30.41   28.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtX   18.01   18.14   18.07   17.97</span>
<span class="r-in"><span><span class="fu">aggregate_by_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">adj</span>, <span class="va">colMeansMat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Sample1  Sample2  Sample3   Sample4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB 10.34750 10.56750 11.10750 11.525000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtE 11.30667 10.81333 10.13667  9.433333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtX  9.00500  9.07000  9.03500  8.985000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ---------------</span></span></span>
<span class="r-in"><span><span class="co">## Missing values</span></span></span>
<span class="r-in"><span><span class="co">## ---------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1 NA  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2  2  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3  3  6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## simply use na.rm = TRUE to ignore missing values</span></span></span>
<span class="r-in"><span><span class="co">## during the aggregation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A" "A" "B"</span>
<span class="r-in"><span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, <span class="va">colSums</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A NA  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B  3  6</span>
<span class="r-in"><span><span class="fu">aggregate_by_vector</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, <span class="va">colSums</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A  2  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B  3  6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>               dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      A B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3 0 1</span>
<span class="r-in"><span><span class="fu">aggregate_by_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">adj</span>, <span class="va">colSumsMat</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A NA  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B  3  6</span>
<span class="r-in"><span><span class="fu">aggregate_by_matrix</span><span class="op">(</span><span class="va">x</span>, <span class="va">adj</span>, <span class="va">colSumsMat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A  2  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B  3  6</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

